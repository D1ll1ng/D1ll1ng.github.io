import{W as st,S as ot,i as nt,s as lt,e as E,k as O,c as k,a as x,m as M,d as T,b as u,F as W,g as A,G as h,X as B,U as I,Y as R,Z as rt,_ as it,$ as dt,a0 as ut,a1 as X,V as L,t as ct,O as ft,h as _t,a2 as ht,p as mt,q as pt,o as bt,I as Y,a3 as vt,n as gt,a4 as yt,E as Tt}from"../../chunks/index-c547a399.js";import{D as wt}from"../../chunks/Document-598d047c.js";import{s as qt,b as Et,a as V,d as kt}from"../../chunks/firebase-4329e9e7.js";import"../../chunks/index-1323b221.js";function Q(c){const a=c-1;return a*a*a+1}function Z(c,{delay:a=0,duration:e=400,easing:r=Q,start:f=0,opacity:p=0}={}){const d=getComputedStyle(c),o=+d.opacity,m=d.transform==="none"?"":d.transform,n=1-f,_=o*(1-p);return{delay:a,duration:e,easing:r,css:(i,y)=>`
			transform: ${m} scale(${1-n*y});
			opacity: ${o-_*y}
		`}}function Dt(c,{from:a,to:e},r={}){const f=getComputedStyle(c),p=f.transform==="none"?"":f.transform,[d,o]=f.transformOrigin.split(" ").map(parseFloat),m=a.left+a.width*d/e.width-(e.left+d),n=a.top+a.height*o/e.height-(e.top+o),{delay:_=0,duration:i=b=>Math.sqrt(b)*120,easing:y=Q}=r;return{delay:_,duration:st(i)?i(Math.sqrt(m*m+n*n)):i,easing:y,css:(b,v)=>{const w=v*m,s=v*n,l=b+v*a.width/e.width,t=b+v*a.height/e.height;return`transform: ${p} translate(${w}px, ${s}px) scale(${l}, ${t});`}}}class j extends wt{constructor(a={}){super(a),this._collection="todos",this.text="",this.done=!1,this.pending_delete=!1,this._load(a),this._dbFields.push("text","done")}}const{document:z}=vt;function J(c,a,e){const r=c.slice();return r[15]=a[e],r[16]=a,r[17]=e,r}function K(c,a){let e,r,f,p,d,o,m,n,_,i,y,b,v,w,s,l,t,q,U,C=Tt,F,P,G;function $(){return a[10](a[15])}function tt(){a[11].call(i,a[16],a[17])}function et(){return a[12](a[15])}function at(){return a[13](a[15])}return{key:c,first:null,c(){e=E("div"),r=E("form"),f=E("input"),d=O(),o=E("button"),n=O(),_=E("form"),i=E("input"),y=O(),b=E("button"),v=O(),w=E("form"),s=E("button"),t=O(),this.h()},l(D){e=k(D,"DIV",{class:!0});var g=x(e);r=k(g,"FORM",{});var N=x(r);f=k(N,"INPUT",{type:!0,name:!0,class:!0}),d=M(N),o=k(N,"BUTTON",{class:!0,"aria-label":!0}),x(o).forEach(T),N.forEach(T),n=M(g),_=k(g,"FORM",{class:!0});var S=x(_);i=k(S,"INPUT",{"aria-label":!0,type:!0,name:!0,class:!0}),y=M(S),b=k(S,"BUTTON",{class:!0,"aria-label":!0}),x(b).forEach(T),S.forEach(T),v=M(g),w=k(g,"FORM",{});var H=x(w);s=k(H,"BUTTON",{class:!0,"aria-label":!0}),x(s).forEach(T),H.forEach(T),t=M(g),g.forEach(T),this.h()},h(){u(f,"type","hidden"),u(f,"name","done"),f.value=p=a[15].done?"":"true",u(f,"class","svelte-dmxqmd"),u(o,"class","toggle svelte-dmxqmd"),u(o,"aria-label",m="Mark todo as "+(a[15].done?"not done":"done")),u(i,"aria-label","Edit todo"),u(i,"type","text"),u(i,"name","text"),u(i,"class","svelte-dmxqmd"),u(b,"class","save svelte-dmxqmd"),u(b,"aria-label","Save todo"),u(_,"class","text svelte-dmxqmd"),u(s,"class","delete svelte-dmxqmd"),u(s,"aria-label","Delete todo"),s.disabled=l=a[15].pending_delete,u(e,"class","todo svelte-dmxqmd"),W(e,"done",a[15].done),this.first=e},m(D,g){A(D,e,g),h(e,r),h(r,f),h(r,d),h(r,o),h(e,n),h(e,_),h(_,i),B(i,a[15].text),h(_,y),h(_,b),h(e,v),h(e,w),h(w,s),h(e,t),F=!0,P||(G=[I(r,"submit",R($)),I(i,"input",tt),I(_,"submit",R(et)),I(w,"submit",R(at))],P=!0)},p(D,g){a=D,(!F||g&2&&p!==(p=a[15].done?"":"true"))&&(f.value=p),(!F||g&2&&m!==(m="Mark todo as "+(a[15].done?"not done":"done")))&&u(o,"aria-label",m),g&2&&i.value!==a[15].text&&B(i,a[15].text),(!F||g&2&&l!==(l=a[15].pending_delete))&&(s.disabled=l),g&2&&W(e,"done",a[15].done)},r(){U=e.getBoundingClientRect()},f(){rt(e),C(),it(e,U)},a(){C(),C=dt(e,U,Dt,{duration:200})},i(D){F||(D&&ut(()=>{q||(q=X(e,Z,{start:.7},!0)),q.run(1)}),F=!0)},o(D){D&&(q||(q=X(e,Z,{start:.7},!1)),q.run(0)),F=!1},d(D){D&&T(e),D&&q&&q.end(),P=!1,L(G)}}}function xt(c){let a,e,r,f,p,d,o,m,n=[],_=new Map,i,y,b,v=c[1];const w=s=>s[15]._id;for(let s=0;s<v.length;s+=1){let l=J(c,v,s),t=w(l);_.set(t,n[s]=K(t,l))}return{c(){a=O(),e=E("div"),r=E("h1"),f=ct("Todos"),p=O(),d=E("form"),o=E("input"),m=O();for(let s=0;s<n.length;s+=1)n[s].c();this.h()},l(s){ft('[data-svelte="svelte-181o7gf"]',z.head).forEach(T),a=M(s),e=k(s,"DIV",{class:!0});var t=x(e);r=k(t,"H1",{});var q=x(r);f=_t(q,"Todos"),q.forEach(T),p=M(t),d=k(t,"FORM",{class:!0,method:!0});var U=x(d);o=k(U,"INPUT",{name:!0,"aria-label":!0,placeholder:!0,class:!0}),U.forEach(T),m=M(t);for(let C=0;C<n.length;C+=1)n[C].l(t);t.forEach(T),this.h()},h(){z.title="Todos",u(o,"name","text"),u(o,"aria-label","Add todo"),u(o,"placeholder","+ tap to add a todo"),u(o,"class","svelte-dmxqmd"),u(d,"class","new svelte-dmxqmd"),u(d,"method","post"),u(e,"class","todos svelte-dmxqmd")},m(s,l){A(s,a,l),A(s,e,l),h(e,r),h(r,f),h(e,p),h(e,d),h(d,o),B(o,c[0]),h(e,m);for(let t=0;t<n.length;t+=1)n[t].m(e,null);i=!0,y||(b=[I(o,"input",c[8]),I(d,"submit",R(c[9]))],y=!0)},p(s,[l]){if(l&1&&o.value!==s[0]&&B(o,s[0]),l&114){v=s[1],gt();for(let t=0;t<n.length;t+=1)n[t].r();n=ht(n,l,w,1,s,v,_,e,yt,K,null,J);for(let t=0;t<n.length;t+=1)n[t].a();mt()}},i(s){if(!i){for(let l=0;l<v.length;l+=1)pt(n[l]);i=!0}},o(s){for(let l=0;l<n.length;l+=1)bt(n[l]);i=!1},d(s){s&&T(a),s&&T(e);for(let l=0;l<n.length;l+=1)n[l].d();y=!1,L(b)}}}const It=async function({fetch:a}){const e=await a("/api/data?collectionPath=todos");if(e.ok)return{props:{todosData:await e.json()}};throw await e.json()};function Ot(c,a,e){let r,f;Y(c,qt,t=>e(14,r=t));let{todosData:p}=a;if(!r.user)throw"Cannot access todos without a user.";let d=Et(j,"todos",r.user.uid,p.map(t=>new j(t)));Y(c,d,t=>e(1,f=t));let o="";async function m(){if(!r.user)throw"Cannot add todo without a user.";const t=new j;t.uid=r.user.uid,t.text=o,V(t),e(0,o="")}async function n(t){t.done=!t.done,V(t)}async function _(t){V(t),document.activeElement&&document.activeElement.blur()}async function i(t){t.pending_delete=!0,kt(t)}function y(){o=this.value,e(0,o)}const b=()=>m(),v=t=>n(t);function w(t,q){t[q].text=this.value,d.set(f)}const s=t=>_(t),l=t=>i(t);return c.$$set=t=>{"todosData"in t&&e(7,p=t.todosData)},[o,f,d,m,n,_,i,p,y,b,v,w,s,l]}class Nt extends ot{constructor(a){super(),nt(this,a,Ot,xt,lt,{todosData:7})}}export{Nt as default,It as load};
